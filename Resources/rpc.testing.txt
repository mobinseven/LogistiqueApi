# -*- coding: utf-8 -*-
"""
Created on Mon Mar 30 10:15:48 2020

@author: sabersk
"""
def solver(strjson):
    import xmlrpc.client
    import json
    import io

    Route={}

    data = json.loads(strjson) 
    vehicle_ID=list(data['vehicle'].keys())
    request_ID=list(data['request'].keys())
    depot_ID=data['vehicle'][vehicle_ID[0]]['start_location_id']
    #Send the problem to server            
    with xmlrpc.client.ServerProxy("http://213.233.161.191:8001/") as proxy:
        Output=proxy.processjson(strjson)
    R = Output[0]
    Route['Status'] = Output[1]
    T = Output[2]
    routes={}
    cnt=0
    for r in R:
        O=[]
        # origin
        o={}
        o['order']=0
        o['requestId']=depot_ID
        o['time']=T[cnt][0]
        O.append(o)
        ocnt=1
        for  v in r[1:-1]:
            o={}
            o['order']=ocnt
            o['requestId']=request_ID[v-1]
            o['time']=T[cnt][ocnt]
            O.append(o)
            ocnt=ocnt+1
        o={}
        o['order']=ocnt
        o['requestId']=depot_ID
        o['time']=''
        O.append(o)
        routes[vehicle_ID[cnt]]=O
        cnt=cnt+1
    Route['Routes']=routes
    return Route